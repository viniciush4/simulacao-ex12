<html>
    <head>
        <title>Simulação - 12</title>
        <style>
            canvas {
                position: absolute;
                top: 0px;
                bottom: 0px;
                left: 0px;
                right: 0px;
                margin: auto;
            }
        </style>
    </head>
    <body>
        <script>
            // variáveis do jogo
            var canvas, ctx, ALTURA, LARGURA, velocidade = 10, carros, L, d;
            
            // carro = {
            //     x: 0,
            //     y: 0,
            //     altura: 50,
            //     largura: 50,
            //     velocidade: 0.3,

            //     atualiza: function(){
            //         this.x += this.velocidade;                   

            //     },
            //     desenha: function(){
            //         ctx.fillStyle = 'green';
            //         ctx.fillRect(this.x, this.y, this.altura, this.largura);
            //     }
            // };
            
            // obstaculos = {
            //     _obs: [],
            //     cores: ['#ffbc1c', '#ff1c1c', '#ff85e1'],
            //     tempoInsere: 0,
                
            //     insere: function(){
            //         this._obs.push({
            //             x: LARGURA,
            //             largura: 50,
            //             altura: 30 + Math.floor(120 * Math.random()),
            //             cor: this.cores[Math.floor(Math.random() * 3)]
            //         });

            //         this.tempoInsere = 50 + Math.floor(20 * Math.random());
            //     },

            //     atualiza: function(){
            //         if(this.tempoInsere == 0){
            //             this.insere();
            //         } else {
            //             this.tempoInsere--;
            //         }

            //         for(let i=0, tam=this._obs.length; i<tam; i++){
            //             var obs = this._obs[i];
                        
            //             obs.x -= velocidade;

            //             if(bloco.x < obs.x+obs.largura && 
            //             bloco.x+bloco.largura >= obs.x && 
            //             bloco.y+bloco.altura >= chao.y-obs.altura)
            //                 estadoAtual = estados.perdeu;

            //             else if(obs.x == 0)
            //                 bloco.score++;

            //             else if(obs.x <= -obs.largura){
            //                 this._obs.splice(i,1);
            //                 tam--;
            //                 i--;
            //             }
            //         }
            //     },

            //     limpa: function(){
            //         this._obs = [];
            //     },

            //     desenha: function(){
            //         for(let i=0, tam=this._obs.length; i<tam; i++){
            //             var obs = this._obs[i];
            //             ctx.fillStyle = obs.cor;
            //             ctx.fillRect(obs.x, chao.y-obs.altura, obs.largura, obs.altura);
            //         }
            //     }
            // };


            // function clique(event){
            //     if(estadoAtual == estados.jogando)
            //         bloco.pula();
            //     else if(estadoAtual == estados.jogar)
            //         estadoAtual = estados.jogando;
            //     else if(estadoAtual == estados.perdeu && bloco.y >= 5*ALTURA){
            //         estadoAtual = estados.jogar;
            //         obstaculos.limpa();
            //         bloco.reset();
            //     }
            // }


            function main(){
                carros = [];
                ALTURA = 300;
                LARGURA = window.innerWidth - 100;
                L = 50;
                d = 100;

                canvas = document.createElement('canvas');
                canvas.width = LARGURA;
                canvas.height = ALTURA;
                canvas.style.border = '1px solid #000';

                ctx = canvas.getContext('2d');
                document.body.appendChild(canvas);


                // Adiciona carros ao array
                for (var i = 0; i < 50; i++) {
                    
                    carros.push({
                        x: i<3 ? i*(-L) : -(i-3)*(L+d),
                        velocidade: i<3 ? 2 : 3,

                        atualiza: function(){
                            this.x += this.velocidade;                   

                        },
                        desenha: function(){
                            ctx.fillStyle = 'green';
                            ctx.fillRect(this.x, 0, L-10, 30);
                        }
                    });
                }

                

                

                // document.addEventListener('mousedown', clique);
                // document.body.onkeydown = clique;

                // estadoAtual = estados.jogar;
                // record = localStorage.getItem('record');

                // if(record == null)
                    // record = 0;

                // img = new Image();
                // img.src = 'img/sprite.svg';

                roda();
            }

        
            function roda(){
                atualiza();
                desenha();
                window.requestAnimationFrame(roda);
            }


            function atualiza(){
                // bg.atualiza();
                carros.forEach(carro => {
                    carro.atualiza(); 
                });
                // bloco.atualiza();
                // if(estadoAtual == estados.jogando){
                    // obstaculos.atualiza();
                // }
            }


            function desenha(){
                ctx.clearRect(0, 0, LARGURA, ALTURA);

                // ctx.fillStyle = '#80daff';
                // ctx.fillRect(0, 0, LARGURA, ALTURA);

                carros.forEach(carro => {
                    carro.desenha(); 
                });

                // ctx.fillStyle = '#fff';
                // ctx.font = '50px Arial';
                // ctx.fillText(bloco.score, 30, 68);

                // if(estadoAtual == estados.jogar){
                //     ctx.fillStyle = 'green';
                //     ctx.fillRect(LARGURA/2-50, ALTURA/2-50, 100, 100);

                // } else if(estadoAtual == estados.perdeu) {
                //     ctx.fillStyle = 'red';
                //     ctx.fillRect(LARGURA/2-50, ALTURA/2-50, 100, 100);
                //     ctx.save();
                //     ctx.translate(LARGURA/2, ALTURA/2);
                //     ctx.fillStyle = '#fff';


                //     if(bloco.score > record)
                //         ctx.fillText('Novo Record!', -150, -65);
                //     else if (record < 10)
                //         ctx.fillText('Record '+record, -99, -65);
                //     else if(record >= 10 && record < 100)
                //         ctx.fillText('Record '+record, -112, -65);
                //     else
                //         ctx.fillText('Record '+record, -125, -65)


                //     if(bloco.score < 10)
                //         ctx.fillText(bloco.score, -13, 18);
                //     else if(bloco.score >= 10 && bloco.score < 100)
                //         ctx.fillText(bloco.score, -27, 18);
                //     else
                //         ctx.fillText(bloco.score, -40, 18);


                    // ctx.restore();

                // } else if(estadoAtual == estados.jogando){
                //     obstaculos.desenha();
                // }

                // chao.desenha();
                // bloco.desenha();
            }


            main();
        </script>
    </body>
</html>